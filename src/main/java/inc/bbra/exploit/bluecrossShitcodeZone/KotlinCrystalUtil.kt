package inc.bbra.exploit.bluecrossShitcodeZone

import inc.bbra.exploit.mc
import inc.bbra.exploit.utils.CrystalUtil
import inc.bbra.exploit.utils.EntityUtil
import net.minecraft.entity.item.EntityEnderCrystal
import net.minecraft.entity.player.EntityPlayer
import net.minecraft.util.EnumHand
import net.minecraft.util.math.BlockPos

fun getBestCrystals(
    target: EntityPlayer,
    range: Int,
    minDmg: Int,
    selfDmg: Int,
    multiplace: Int,
    faceplace: Boolean,
    placementMode: String
): ArrayList<BlockPos> {
    var possibles = CrystalUtil.possiblePlacePositions(range.toFloat(), true, false)
    var pos2return = arrayListOf<BlockPos>()
    possibles.removeIf {
        CrystalUtil.calculateDamage(it, mc.player, false) > selfDmg
        CrystalUtil.calculateDamage(it, target, faceplace) < minDmg
    }
    if (possibles.size >= multiplace) {
        when (placementMode) {
            "Benefit" -> {
                repeat(multiplace) {
                    pos2return.add(
                        possibles.maxBy {
                            CrystalUtil.calculateDamage(it, target, faceplace) - CrystalUtil.calculateDamage(
                                it,
                                StrongAura.mc.player,
                                false
                            )
                        }!!
                    )
                }
            }
            "Damage" -> {
                repeat(multiplace) {
                    pos2return.add(
                        possibles.maxBy {
                            CrystalUtil.calculateDamage(it, target, faceplace)
                        }!!
                    )
                }
            }
        }
    }
    return pos2return;
}
