package inc.bbra.exploit.clickgui.modules.settings;

import inc.bbra.exploit.BBraExploit;
import inc.bbra.exploit.Module.Module;
import inc.bbra.exploit.clickgui.UtilGui;
import net.minecraft.client.Minecraft;
import net.minecraft.client.gui.Gui;

import java.awt.*;
import java.text.DecimalFormat;

public class FloatSetting extends SettingAbstract {

    float min, max;
    float value;
    ///////drag stuff
    boolean dragging;
    int dragX;
    int startX;
    public int mouseX;
    int preDragIndicatorX;
    /////////////////
    int indicatorX = 30;  // max = 80

    public FloatSetting(Module module, String name, float value, float min, float max) {
        super(module, name);
        if (value > min && value < max) {
            this.value = value;
        } else if (value < min) {
            this.value = min;
        } else if (value > max) {
            this.value = max;
        }
        this.min = min;
        this.max = max;
    }

    public FloatSetting(Module module, String name, PageSetting page, float value, float min, float max) {
        super(module, name, page);
        if (value > min && value < max) {
            this.value = value;
        } else if (value < min) {
            this.value = min;
        } else if (value > max) {
            this.value = max;
        }
        this.min = min;
        this.max = max;
    }

    @Override
    public void draw() {
        if (dragging) {
            dragX = mouseX - startX - (x + 25);
            if (preDragIndicatorX + dragX > 70) {
                indicatorX = 70;
            } else if (preDragIndicatorX + dragX < 0) {
                indicatorX = 0;
            } else {
                indicatorX = preDragIndicatorX + dragX;
            }
            getValueFromIndicator( );
        }
        if (!hovered) {
            Minecraft.getMinecraft( ).fontRenderer.drawString(name, x + 5, y + 4, Color.WHITE.hashCode( ));
            Minecraft.getMinecraft( ).fontRenderer.drawString(value + "", x + w - 17, y + 4, Color.WHITE.hashCode( ));
        } else {
            Minecraft.getMinecraft( ).fontRenderer.drawString(value + "", x + 5, y + 4, Color.WHITE.hashCode( ));
            /////////////////////////////////////// Drager

            Gui.drawRect(x + 25, y + 7, x + w - 5, y + 8, Color.WHITE.hashCode( ));  // line
            /////////////////// Borders
            Gui.drawRect(x + 25, y + 4, x + 24, y + h - 4, Color.WHITE.hashCode( ));
            Gui.drawRect(x + w - 5, y + 4, x + w - 4, y + h - 4, Color.WHITE.hashCode( ));
            ///////////////// Indicator
            Gui.drawRect(x + 25 + indicatorX - 1, y + 2, x + 25 + indicatorX + 1, y + h - 2, button.getBorderColor( ));

        }
    }

    public void onMouseClick(int mouseX, int mouseY, int mouseButton) {
        if (UtilGui.isClicked(mouseX, mouseY, mouseButton, x + 25, y + 2, 80, 11, UtilGui.MOUSEBUTTON.LEFT)) {
            dragging = true;
            startX = mouseX - (x + 25);
            indicatorX = startX;
            preDragIndicatorX = indicatorX;
        }
    }

    public void onMouseRelease(int mouseX, int mouseY) {
        dragging = false;
        dragX = 0;
        startX = 0;
        preDragIndicatorX = indicatorX;
    }

    public void getValueFromIndicator() {
        DecimalFormat decimalFormat = new DecimalFormat("#.#");
        value = Float.parseFloat(decimalFormat.format(min + ((max - min) / 70 * indicatorX)));
    }

    public float getVal() {
        return value;
    }
}
